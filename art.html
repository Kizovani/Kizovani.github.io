<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/css" rel="stylesheet" href="main.css">
    <title>Kizovani - Art</title>
    <style>
       :root {
    --white: #ffffff;
    --black: #000000;
  }

  @font-face {
    font-family: "Arame Mono";
    src: url("/res/fonts/ArameMono.ttf") format("truetype");
}

@font-face {
  font-family: "Hack-Regular";
  src: url(/res/fonts/Hack-Regular.ttf);
}

@font-face {
  font-family: "Hack-Bolditalic";
src: url(/res/fonts/Hack-BoldItalic.ttf);
}

@font-face {
  font-family: "Hack-Italic";
  src: url(/res/fonts/Hack-Italic.ttf);
}

@font-face {
  font-family: "Hack-Bold";
  src: url(/res/fonts/Hack-Bold.ttf);
}

html, body {
    width: 100%;
    height: 100%;
    font-family: "Arame Mono";
}
img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.img-previews {
    position: absolute;
    top: 0%;
    left: 50%;
    transform: translateX(-50%);
    width: 600px; /* Fixed width instead of percentage */
    padding-bottom: 50vh; /* Space for scrolling */
}
.img-preview-container {
    position: relative;
}
.img-previews img {
    width: 100%;
    height: 700px;
    object-fit: cover; /* Consistent image cropping */
    margin-bottom: 1em;
}
.gallery-container {
    width: 100%;
    height: 100%;
    padding-top: 4em;
}
.gallery.layout-2-gallery {
    position: fixed;
    top: 25%;
    left: 10%;
    transform: translateX(0%);
    width: 75px; /* Fixed width */
}
.gallery.layout-2-gallery .img {
    width: 100%;
    height: 90px;
    margin-bottom: 1em;
    overflow: hidden;
}
.gallery.layout-2-gallery img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Match main gallery cropping */
}

.minimap {
    position: fixed;
    top: 50%;           /* Center vertically */
    left: 100px;        /* Fixed distance from left */
    transform: translateY(-50%); /* Center the element itself */
    transform: translateX(0);
    width: 180px;
    height: 100px;
    border: 2px solid var(--white);
    border-radius: 2px;
    z-index: 2;
    background: rgba(255, 255, 255, 0.1);
    pointer-events: none;
    will-change: transform;
}

/* Adjust the highlight style */
.minimap-highlight {
    position: absolute;
    width: 100%;
    height: 30px;
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(0);
}

.minimap::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 30px;
    background: rgba(255, 255, 255, 0.4); /* More visible indicator */
    top: 0;
    left: 0;
    border-radius: 1px;
}
.lenis.lenis-smooth {
    scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
    overscroll-behavior: contain;
}
.lenis.lenis-stopped {
    overflow: hidden;
}
.lenis.lenis-smooth iframe {
 pointer-events: none;   
}
.img-previews .preview-container {
            position: relative;
            width: 100%;
            height: 700px;
            margin-bottom: 1em;
        }
 .img-previews .preview-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    }
    .text-overlay {
    position: absolute;
    width: 90%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    text-align: center;
    background-color: rgba(255, 255, 255, 0.9);
    opacity: 0;
    transition: opacity 0.3s ease;
}
.overlay-text {
    color: black;
    font-family: "Arame Mono";
    font-size: 24px;
    padding: 30px;
    width: 100%;
    border-radius: 4px;
    z-index: 2;
    white-space: pre-line;
    line-height: 0.9;
}
        

    </style>
</head>
<body>
    <div class="gallery-container">
        <div class="gallery layout-2-gallery">
            <div class="img" id="img1">
                <img src="res/art/fallen_angel.jpg" alt="fallen_angel">
            </div>
            <div class="img" id="img2">
                <img src="res/art/I_LAUGH_BECAUSE_I_AM_WEAK.png" alt="fallen_angel">
            </div>
            <div class="img" id="img3">
                <img src="/res/art/I'M_IN_HELL.png" alt="wolf">
            </div>
            <div class="img" id="img4">
                <img src="/res/art/IT_KEEPS_GETTING_WORSE.png" alt="placeholder">
            </div>
            <div class="img" id="img5">
                <img src="res/art/LETS_NEGOTIATE.png" alt="placeholder">
            </div>
            <div class="img" id="img6">
                <img src="res/art/Melencolia.png" alt="placeholder">
            </div>
            <div class="img" id="img7">
                <img src="/res/art/Screenshot 2024-12-13 at 22-32-59 PITCH CANKER (@pitchcanker) • Instagram photos and videos.png" alt="placeholder">
            </div>
            <div class="img" id="img8">
                <img src="res/art/TEST.png" alt="placeholder">
            </div>
            <div class="img" id="img9">
                <img src="res/art/The_Agression_Sessions.png" alt="placeholder">
            </div>

        </div>
    </div>

    <div class="minimap"></div>

    <div class="img-previews">
        <div class="preview-container">
            <img src="res/art/fallen_angel.jpg" alt="fallen_angel">
            <div class="text-overlay">
                <div class="overlay-text">Alexandre Cabanel <br>
                    (French, 1823-1889) <br>
                    "The Fallen Angel" <br>
                    (L'ange déchu) <br>
                    1847 <br>
                    Oil on canvas</div>
            </div>
        </div>
        <div class="preview-container">
            <img src="res/art/I_LAUGH_BECAUSE_I_AM_WEAK.png" alt="">
            <div class="text-overlay">
                <div class="overlay-text">Micheal <br>
                    Is <br>
                    A <br>
                    Real nice <br>
                    Fella <br>
                     nigga  
                    </div>
            </div>
        </div>
        
        <img src="/res/art/I'M_IN_HELL.png" alt="wolf">
        <img src="res/art/IT_KEEPS_GETTING_WORSE.png" alt="placeholder">
        <img src="res/art/LETS_NEGOTIATE.png" alt="">
        <img src="res/art/Melencolia.png" alt="">
        <img src="/res/art/Screenshot 2024-12-13 at 22-32-59 PITCH CANKER (@pitchcanker) • Instagram photos and videos.png" alt="">
        <img src="res/art/TEST.png" alt="">
        <img src="res/art/The_Agression_Sessions.png" alt="">

    </div>

    <div class="menu-container">
        <div class="col col-1">
            <div class="menu-item" id="menu-toggle">menu</div>
        </div>
        <div class="col col-2">
            <div class="menu-item" id="close-menu">close</div>
            <div class="menu-item"><a href="index.html">home</a></div>
            <div class="menu-item"><a href="projects.html">projects</a></div>
            <div class="menu-item">art i like</div>
            <div class="menu-item"><a href="info.html">info</a></div>
            <div class="menu-item">contact</div>
        </div>
    </div>
    <div class="marquee-container">
        <div class="marquee">
            projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects projects
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.1/gsap.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script type="module" src="/main.js"></script>

    <!-- typewriter-effect I might use -->
    <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>


    <!-- GSAP Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Flip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script src="https://unpkg.com/lenis@1.1.18/dist/lenis.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/baffle@0.3.6/dist/baffle.min.js"></script>

    <script>
        //HERE: ADJUST THIS TO MOVE THE MINI GALLERY FASTER OR SLOWER (HIGHER IS FASTER)
        const SCALING_RATIO = 1.18;

        const lenis = new Lenis();
function raf(time) {
    lenis.raf(time);
    requestAnimationFrame(raf);
}
requestAnimationFrame(raf);

// gsap.registerPlugin(ScrollToPlugin);

const gallery = document.querySelector('.layout-2-gallery');
const imgPreviews = document.querySelector('.img-previews');
const minimap = document.querySelector('.minimap');

if (!minimap.querySelector('.minimap-highlight')) {
    const highlight = document.createElement('div');
    highlight.className = 'minimap-highlight';
    minimap.appendChild(highlight);
}

function handleScroll() {
    // Get the highlight element
    const highlight = minimap.querySelector('.minimap-highlight');
    
    // Get dimensions
    const previewsRect = imgPreviews.getBoundingClientRect();
    const minimapHeight = minimap.offsetHeight;
    const highlightHeight = highlight.offsetHeight;
    const viewportHeight = window.innerHeight;
    const totalScrollHeight = imgPreviews.scrollHeight - viewportHeight;
    
    // Calculate scroll progress as a ratio of how far through the previews we've scrolled
    const scrollProgress = window.scrollY / totalScrollHeight;
    const boundedProgress = Math.min(Math.max(scrollProgress, 0), 1);
    
    // Calculate available travel space in minimap
    const availableMinimapTravel = minimapHeight - highlightHeight;
    
    // Move highlight
    const highlightY = boundedProgress * availableMinimapTravel;
    
    gsap.to(highlight, {
        y: highlightY,
        duration: 0.1,
        ease: "none"
    });

    // Move gallery with same ratio
    const galleryStart = viewportHeight * 0.25;
    const maxTravel = viewportHeight * SCALING_RATIO;
    const galleryY = galleryStart - (boundedProgress * maxTravel);

    gsap.to(gallery, {
        y: galleryY,
        duration: 0.1,
        ease: "none"
    });

    // Debug info
    console.log({
        scrollProgress,
        highlightY,
        totalHeight: imgPreviews.scrollHeight,
        scrollY: window.scrollY
    });
}

// Use only Lenis for smooth scrolling
lenis.on('scroll', handleScroll);

// Initialize on load
window.addEventListener('load', handleScroll);

//maybe using hover instead?
//DESCRIPTION TEXT:
// Alexandre Cabanel (French, 1823-1889)
// "The Fallen Angel" (L'ange déchu), 1847
// Oil on canvas

//will need this for descriptions to pop up on view

function isInViewport(element) {
    const rect = element.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
    );
}

//TESTING AREA::

//wait for page to load
document.addEventListener('DOMContentLoaded', () => {
    //get all the images
    const previewContainers = document.querySelectorAll('.preview-container');
    //for each image
    previewContainers.forEach((container) => {
        //define the text overlay(box containing everything) and the text element(actual text)
        const textOverlay = container.querySelector('.text-overlay');
        const textElement = container.querySelector('.overlay-text');
        //save the original html
        const originalHtml = textElement.innerHTML;

        let typewriterInstance = null;
        
        //when the mouse enters a preview container
        container.addEventListener('mouseenter', () => {
            // Show overlay
            textOverlay.style.opacity = '1';
            
            // Clear text
            textElement.innerHTML = '';
            
            // Create new typewriter instance
            typewriterInstance = new Typewriter(textElement, {
                delay: 2,
                cursor: '|',
                html: true
            });
            
            // Type out text
            typewriterInstance
                .typeString(originalHtml)
                .start();
        });

        container.addEventListener('mouseleave', () => {
            if (typewriterInstance) {
                // Delete all text quickly
                typewriterInstance
                    .deleteAll(0.1)
                    .start();
                    setTimeout(() => {
                        // Fade out overlay as text deletes
                        textOverlay.style.opacity = '0';
                    }, 750);
                
                
                
                // Reset after fade
                setTimeout(() => {
                    if (typewriterInstance) {
                        typewriterInstance.stop();
                        typewriterInstance = null;
                    }
                    textElement.innerHTML = originalHtml;
                }, 1100);
            }
        });
    });
});
    </script>
</body>
</html>